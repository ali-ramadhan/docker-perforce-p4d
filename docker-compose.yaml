services:
  perforce:
    build: .
    container_name: perforce-p4d
    restart: unless-stopped
    ports:
      - "1666:1666"
    environment:
      - P4PORT=1666
      - P4USER=admin
      - P4PASSWD=changeme
      - P4SECURITY=1
    volumes:
      # Metadata (ideally on NVMe/SSD)
      - p4_metadata:/opt/perforce/server

      # Depots (could be on HDD)
      - p4_depots:/opt/perforce/server/depots

volumes:
  p4_metadata:
  p4_depots:
